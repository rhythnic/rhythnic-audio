function RhythnicAudio(e,t){var n=this;n.audio=document.createElement("audio");n.bTimeSlide=false;n.options=t||{};n.tracks=[];n.titles=[];n.current=0;n.elem=e;n.controls=n.elem.querySelector(".controls");n.playlist=n.elem.querySelector(".playlist");n.play=n.controls.querySelector(".play");n.seek=n.controls.querySelector(".seek");n.duration=n.controls.querySelector(".duration");n.time=n.controls.querySelector(".time");n.playlistView=n.elem.querySelector(".toggle-playlist-view")}RhythnicAudio.prototype.audioTest=function(){if(!this.audio.canPlayType)throw new Error("Your browser doesn't support the audio tag.\nPlaylist will be a list of audio links.")};RhythnicAudio.prototype.init=function(){var e=this;e.audioTest();e.controls.style.display="block";e.overrideOptions(e.defaultOptions,e.options);e.getTracksAndTitles(e.playlist);e.removeElementFocus();e.audioSetup();e.bindEvents();if(e.tracks.length<=1){e.playlistView.style.display="none"}else{if(e.options.hidePlaylist){e.options.hidePlaylist=false;e.togglePlaylistView()}if(e.options.lockPlaylist)e.playlistView.style.display="none"}if(e.options.autoplay)e.togglePlay(e.audio.paused)};RhythnicAudio.prototype.bindEvents=function(){var e=this;e.controls.addEventListener("click",function(t){switch(t.target){case e.play:e.togglePlay(e.audio.paused);break;case e.playlistView:e.togglePlaylistView();break}},false);e.elem.addEventListener("click",function(t){if(t.target.nodeName=="A"){t.preventDefault();if(t.target.parentElement.className.indexOf("selected")==-1){e.playTrack(e.titles.indexOf(t.target))}else{e.togglePlay(e.audio.paused)}}},false);e.elem.addEventListener("keydown",function(t){switch(t.keyCode){case 32:t.preventDefault();e.togglePlay(e.audio.paused);break;case 37:t.preventDefault();e.audio.currentTime-=2;break;case 39:t.preventDefault();e.audio.currentTime+=2;break;case 38:t.preventDefault();e.playTrack(e.current-1);break;case 40:t.preventDefault();e.playTrack(e.current+1);break}},false);e.seek.addEventListener("keydown",function(e){switch(e.keyCode){}},false);e.audio.addEventListener("loadedmetadata",function(){if(e.audio.duration!=Number.POSITIVE_INFINITY&&e.audio.duration!=Number.NEGATIVE_INFINITY){e.seek.max=e.audio.duration;e.duration.innerHTML="/"+e.formatTime(e.audio.duration)}else{e.duration.innerHTML="?:??"}},false);e.audio.addEventListener("timeupdate",function(){if(!e.bTimeSlide){e.seek.value=e.audio.currentTime;e.time.innerHTML=e.formatTime(e.audio.currentTime)}},false);e.audio.addEventListener("ended",function(){if(e.tracks.length>1){e.playTrack(e.current+1)}else{e.togglePlay(false)}},false);e.seek.addEventListener("mousedown",function(){e.bTimeSlide=true},false);e.seek.addEventListener("change",function(){e.time.innerHTML=e.formatTime(e.seek.value)},false);e.seek.addEventListener("mouseup",function(){e.audio.currentTime=e.seek.value;e.bTimeSlide=false},false);e.seek.addEventListener("touchstart",function(){e.bTimeSlide=true},false);e.seek.addEventListener("touchmove",function(){e.time.innerHTML=e.formatTime(e.seek.value)},false);e.seek.addEventListener("touchend",function(){e.audio.currentTime=e.seek.value;e.bTimeSlide=false},false)};RhythnicAudio.prototype.playTrack=function(e){this.titles[this.current].parentElement.className=this.titles[this.current].parentElement.className.replace(" selected","");this.current=e<0?this.tracks.length-1:e%this.tracks.length;this.titles[this.current].parentElement.className+=" selected";this.audio.src=this.tracks[this.current];this.togglePlay(this.audio.paused)};RhythnicAudio.prototype.audioSetup=function(){if(this.audio.canPlayType("audio/"+this.options.mime)){this.audio.type="audio/"+this.options.mime}else{var e=false;for(var t in this.options.tracks){if(this.audio.canPlayType("audio/"+t)){this.audio.type="audio/"+t;this.tracks=this.options.tracks[t];e=true}}if(!e)throw new Error("Your browser doesn't support any of the provided audio file types.")}this.audio.src=this.tracks[this.current];this.titles[this.current].parentElement.className+=" selected"};RhythnicAudio.prototype.togglePlay=function(e){if(e){this.audio.play();this.play.className=this.play.className.replace(this.options.playIcon,this.options.pauseIcon)}else{this.audio.pause();this.play.className=this.play.className.replace(this.options.pauseIcon,this.options.playIcon)}};RhythnicAudio.prototype.getTracksAndTitles=function(e){var t=this;t.titles=t.querySelectAll(e,["A"]);t.titles.forEach(function(e){t.tracks.push(e.href)})};RhythnicAudio.prototype.querySelectAll=function(e,t){function r(e){if(t.indexOf(e.nodeName)!=-1){n.push(e)}else{for(var i=0;i<e.children.length;i++){r(e.children[i])}}}var n=[];r(e);return n};RhythnicAudio.prototype.togglePlaylistView=function(){if(this.options.hidePlaylist==true){this.playlist.className=this.playlist.className.replace(" hide","");this.options.hidePlaylist=false}else{this.playlist.className+=" hide";this.options.hidePlaylist=true}};RhythnicAudio.prototype.formatTime=function(e){var t=Math.floor(e%60);return Math.floor(e/60)+":"+(t<10?"0"+t:t)};RhythnicAudio.prototype.removeElementFocus=function(){this.titles.forEach(function(e){e.setAttribute("tabindex","-1");e.style.outline="none"})};RhythnicAudio.prototype.overrideOptions=function(e,t){for(var n in e){if(!(n in t)){t[n]=e[n]}}};RhythnicAudio.prototype.defaultOptions={mime:"mp4",autoplay:false,hidePlaylist:false,lockPlaylist:false,playIcon:"fa-play",pauseIcon:"fa-pause",tracks:{}}